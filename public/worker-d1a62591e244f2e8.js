self.addEventListener("push",function(n){let i=n.data?n.data.json():{},t=i.title||"Jeko eSIM 貼心提醒",o={body:i.body||"您有一則新訊息",icon:"/icons/icon-192x192.png",badge:"/icons/icon-192x192.png",vibrate:[200,100,200],data:{url:i.url||"/"}};n.waitUntil(self.registration.showNotification(t,o))}),self.addEventListener("notificationclick",function(n){n.notification.close(),n.waitUntil(clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(i){let t=new URL(n.notification.data.url,self.location.origin).href;for(let n=0;n<i.length;n++){let o=i[n];if(o.url===t&&"focus"in o)return o.focus()}if(clients.openWindow)return clients.openWindow(t)}))});